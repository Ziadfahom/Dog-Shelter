{% extends 'base.html' %}
{% load group_check %}
{% load dog_filters %}
{% load static %}

{% block content %}
    <link href="{% static 'dogs_app/css/styles.css' %}" rel="stylesheet">

    <style>
        .modal-body {
            display: flex;
            justify-content: center;  /* align horizontally center in the div */
            align-items: center;      /* align vertically center in the div */
        }
        .styled-table {
            border-collapse: collapse;
            margin: 1px 0;
            font-size: 0.9em;
            font-family: sans-serif;
            min-width: 400px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
        }
        .styled-table thead tr {
            background-color: #009879;
            color: #ffffff;
            text-align: left;
        }
        .styled-table th,
        .styled-table td {
            padding: 11px 20px;
        }
        .styled-table tbody tr {
            border-bottom: thin solid #dddddd;
        }
        .styled-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }
        .attr-name {
            width: 40%;
        }
    </style>

    <div class="container mt-5 ">
        <div class="col-md-9 mx-auto">
            <div class="card border-secondary shadow-lg">
                <div class="card-header bg-dark text-white">
                    <h2 class="card-title">{{ dog_record }}</h2>
                </div>
                <div class="card-header text-center">
                    {% if dog_record.dogImage %}
                        <img id="dog_picture" data-bs-toggle="modal" data-bs-target="#imageModal" src="{{ dog_record.dogImage.url }}" class="card-img-top" alt="Dog Image" style="width: 25rem; height: 20rem; object-fit: cover; cursor: pointer;">
                    {% else %}
                        <img id="dog_picture" data-bs-toggle="modal" data-bs-target="#imageModal" src="{% static 'dogs_app/img/default_dog.jpg' %}" class="card-img-top" alt="Default Dog Image" style="width: 25rem; height: 20rem; object-fit: cover;">
                    {% endif %}
                </div>
                <div class="card-body">
                    <table class="table styled-table table-bordered">
                        <tbody>

                            <tr>
                                <td class="attr-name"><strong>Dog Name</strong></td>
                                <td>{{ dog_record.dogName|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Date of Arrival</strong></td>
                                <td>{{ dog_record.dateOfArrival|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Chip Number</strong></td>
                                <td>{{ dog_record.chipNum|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Gender</strong></td>
                                <td>{{ dog_record.gender|gender_filter }}</td>
                            </tr>

                            <tr>
                                <td><strong>Breed</strong></td>
                                <td>{{ dog_record.breed|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Fur Color</strong></td>
                                <td>{{ dog_record.furColor|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Estimated Date of Birth</strong></td>
                                <td>{{ dog_record.dateOfBirthEst|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Estimated Age (Years)</strong></td>
                                <td>{{ dog_record.dateOfBirthEst|calculate_age }}</td>
                            </tr>

                            <tr>
                                <td><strong>Date of Vaccination</strong></td>
                                <td>{{ dog_record.dateOfVaccination|handle_none }}</td>
                            </tr>

                            <tr>
                                <td><strong>Neutered?</strong></td>
                                <td>{{ dog_record.isNeutered|yes_no_filter }}</td>
                            </tr>

                            <tr>
                                <td><strong>Dangerous?</strong></td>
                                <td>{{ dog_record.isDangerous|yes_no_filter }}</td>
                            </tr>

                            <tr>
                                <td><strong>Date Given Last Kong Toy</strong></td>
                                <td>{{ dog_record.kongDateAdded|handle_none }}</td>
                            </tr>


                            <tr>
                                <td><strong>Owner</strong></td>
                                <td>{{ dog_record.ownerSerialNum|handle_none }}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>

                <div class="card-footer bg-transparent">
                    {% if user.is_authenticated and user|has_group:"Vet" %}
                        <div class="add-dog-button mt-1 action-buttons">
                            <a href="{% url 'update_dog' dog_record.dogID %}" class="btn btn-success me-2">Update</a>
                            <a href="{% url 'delete_dog' dog_record.dogID %}" class="btn btn-danger">Delete</a>
                        </div>
                    {% endif %}
                    <div class="back-button">
                        <a href="{% url 'home' %}" class="btn btn-secondary">Back</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="dogName" class="modal-title text-center w-100"></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="fullImage" src="" alt="Full-sized Dog Image" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function(){
            $('#imageModal').on('show.bs.modal', function (event) {
                var imgElement = document.querySelector('#dog_picture');
                var fullImageElement = document.querySelector('#fullImage');
                fullImageElement.setAttribute('src', imgElement.getAttribute('src'));
            });
        });

        $(document).ready(function(){
            $('#imageModal').on('show.bs.modal', function (event) {
                var imgElement = document.querySelector('#dog_picture');
                var fullImageElement = document.querySelector('#fullImage');
                var dogNameElement = document.querySelector('#dogName');
                fullImageElement.setAttribute('src', imgElement.getAttribute('src'));
                dogNameElement.textContent = '{{ dog_record.dogName }}';
            });
        });
    </script>

{% endblock %}